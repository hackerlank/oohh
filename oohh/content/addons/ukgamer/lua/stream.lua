if SERVER then return endlocal STREAM_URL = "http://epic-empires.co.uk:8000/ukgamer.ogg"local FONTSIZE = 10local BOXHEIGHT = 50-------------------------------------local lastsong = {}local listeners = 0local boxalpha = 0local textalpha = 0local boxy = -BOXHEIGHTlocal fadingin = falselocal fadingout = falsestreamplayer = NULLlocal function drawhud()	if fadingin then		boxy = math.clamp(boxy + 1, -BOXHEIGHT, 0)		boxalpha = math.clamp(boxalpha + 0.01, 0, 0.5)		if boxy == 0 then			textalpha = math.clamp(textalpha + 0.03, 0, 1)		end	end		if fadingout then		textalpha = math.clamp(textalpha - 0.03, 0, 1)		if textalpha == 0 then			boxy = math.clamp(boxy - 1, -BOXHEIGHT, 0)			boxalpha = math.clamp(boxalpha - 0.01, 0, 0.5)		end	end        if fadingin and textalpha == 1 then --the text is the last thing to fade in		fadingin = false	end		if fadingout and boxy == -BOXHEIGHT then		fadingout = false	end		if boxy == -BOXHEIGHT then return end        local listenerstxt, songtext = ""	    if not lastsong.title or not lastsong.artist or lastsong.title == "" or lastsong.artist == "" then        songtext = "Unknown"    else        songtext = lastsong.artist .. " - " .. lastsong.title    end        if listeners == 1 then		listenerstxt = listeners .. " listener"	else		listenerstxt = listeners .. " listeners"	end        local width = math.max((graphics.GetTextSize("segoeui.ttf", songtext).w * FONTSIZE) + 15, 330)    	graphics.DrawRect(Rect(0, boxy, width, BOXHEIGHT), Color(0, 0, 0, boxalpha), 8, nil, nil, nil, nil, false, true, false, false)	    if streamplayer and streamplayer:IsValid() and streamplayer:IsPlaying() then                local fft = streamplayer:GetFFT() --fft size 1024        local x = 0                for i = 1, width / 10 do            local val = (fft[i] ^ 0.7) * 100            local col = Color(1, 0, 0, boxalpha)            col:SetHue(-val + 100)            graphics.DrawRect(Rect(x, (boxy + BOXHEIGHT) - val, 5, val), col)            x = x + 10        end    end        graphics.DrawText("ukgamer's radio (tunein in console)", Vec2(10, 10), "segoeui.ttf", Vec2() + FONTSIZE, Color(1, 1, 1, textalpha))	graphics.DrawText(listenerstxt, Vec2(width - 7, 10), "segoeui.ttf", Vec2() + FONTSIZE, Color(1, 1, 1, textalpha), Vec2(-1, 0))	graphics.DrawText(songtext, Vec2(10, 30), "segoeui.ttf", Vec2() + FONTSIZE, Color(1, 1, 1, textalpha))endlocal function show()    if not streamplayer or not streamplayer:IsValid() then return end    fadingout = false	fadingin = true	timer.Simple(5, function() fadingin = false fadingout = true end)endlocal function startstreamplayer()    if streamplayer and streamplayer:IsValid() then streamplayer:Remove() end    streamplayer = Channel(BASS_URL, STREAM_URL, 0, BASS_STREAM_STATUS)    streamplayer:Play()        streamplayer:SetOnTagsChanged(BASS_TAG_OGG, function(data)        lastsong = data        show()    end)        console.AddCommand("nowplaying", show)        timer.Create("ukstream_timer", 10, 0, function()        http.Get("http://lab.epic-empires.co.uk/stream.php", function(data)            local info = string.explode(data.content, "\n")            listeners = tonumber(info[2]) or 0        end)    end)endlocal function stopstreamplayer()	if streamplayer and streamplayer:IsValid() then        hook.Remove("DrawHUD", "ukstream_nowplaying")        timer.Remove("ukstream_timer")        streamplayer:Remove()    endendhook.Add("DrawHUD", "ukstream_nowplaying", drawhud)console.AddCommand("tunein", startstreamplayer)console.AddCommand("tuneout", stopstreamplayer)